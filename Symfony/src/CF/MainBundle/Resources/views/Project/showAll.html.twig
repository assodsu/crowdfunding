{% extends "CFMainBundle::layout.html.twig" %}

{% block title %}
  	{{ parent() }} - Tous les projets
{% endblock %}

{% block stylesheets %}
	{{ parent() }}
	<link href="{{ asset('css/style_showAll.css') }}" rel="stylesheet"/>
{% endblock %}

{% block body %}
	<div class="search">
		{{ render(controller('CFMainBundle:Recherche:renderSearch')) }}
	</div>

	<div id="content-scrolling">
		<div id="content">
		{% for projet in projets %}
			<a href="{{ path('cf_main_project', {'id' : projet.id}) }}">
				<div  id="project-{{ projet.id }}" class="apercu">
					<div img="{{ projet.background.path }}" class="project-background"></div>
					<div class="filter"></div>
					<div class="project-title">{{ projet.nom }}</div>
					<ul class="project-tags">
						{% for tag in projet.tags %}
							<li class="tag">{{ tag.nom }}</li>
						{% endfor %}
					</ul>
					<div class='chart'>
						<svg height="105" width="105">
							<circle cx="52.5" cy="52.5" r="45" fill="#34495E" />
						</svg>
						<div class='pie-content'>
							<div class='percentage'>75%</div>
							<div class='name'>ressources</br>collectées</div>
						</div>
						<ul class="pie">
							<li class="visualize" data-color="#5cb85c" data-value="12"></li>
							<li class="visualize" data-color="#5bc0de" data-value="30"></li>
							<li class="visualize" data-color="#d9534f" data-value="25"></li>
							<li class="visualize" data-color="#d9534f" data-value="33"></li>
							<li class="visualize" data-color="rgba(0,0,0,0)" data-value="75"></li>
						</ul>
					</div>
				</div>
			</a>
		{% endfor %}
	</div>
	<div class="scrolling-text">
		<i class="fa fa-chevron-down"></i>
		<p>Faire défiler pour découvrir</p>
	</div>
</div>
{% endblock %}
	
{% block javascripts %}
	{{ parent() }}
	<script type="text/javascript" src="{{asset('js/visualize.js')}}"></script>
	<script type="text/javascript" src="{{asset('js/script_showAll.js')}}"></script>
	<script type="text/javascript">
		$('.pie').visualize({
			width: 105,
			height: 105,
			type: 'pie',
			legend: false
		});
		{% if recherche is defined %}
			$('#search-bar input').val('{{ recherche }}');
		{% endif %}

		{% for projet in projets %}
			var img = $('#project-{{ projet.id }}').children('.project-background').attr('img');
			$('#project-{{ projet.id }}').css('background', 'url("../../uploads/'+img+'") center center no-repeat').css('background-size','cover');
		{% endfor %}
	</script>
{% endblock %}